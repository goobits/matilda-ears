[build-system]
requires = [ "setuptools>=61.0",]
build-backend = "setuptools.build_meta"

[project]
name = "goobits-matilda-ears"
version = "1.0.0"
description = "GOOBITS STT - Pure speech-to-text engine with multiple operation modes"
readme = "README.md"
requires-python = ">=3.11"
keywords = [ "speech-to-text", "whisper", "transcription", "stt", "voice",]
classifiers = [ "Development Status :: 4 - Beta", "Intended Audience :: Developers", "Programming Language :: Python :: 3", "Programming Language :: Python :: 3.11", "Programming Language :: Python :: 3.12", "Programming Language :: Python :: 3.13",]
dependencies = [ "websockets>=10.0,<14.0", "numpy>=1.21.0,<3.0", "cryptography>=42.0.0,<44.0", "PyJWT>=2.0.0,<3.0", "aiohttp>=3.8.0,<4.0", "click>=8.0.0,<9.0", "rich-click>=1.7.0,<2.0", "rich>=13.0.0,<14.0", "torch>=2.0.0,<3.0", "torchaudio>=2.0.0,<3.0", "deepmultilingualpunctuation>=1.0.0,<2.0", "spacy>=3.8.0,<4.0", "pyparsing>=3.0.0,<4.0", "intervaltree>=3.1.0,<4.0", "opuslib>=3.0.0,<4.0", "pynput>=1.7.0,<2.0", "pydantic>=2.0.0,<3.0", "bleach>=6.1.0,<7.0", "validators>=0.20.0,<1.0", "pyyaml>=6.0.1,<7.0",]
[[project.authors]]
name = "GOOBITS Team"

[project.license]
text = "MIT"

[project.optional-dependencies]
vad = [ "silero-vad>=5.0.0,<6.0",]
whisper = [ "faster-whisper>=1.0.0,<2.0", "ctranslate2>=4.0.0,<5.0",]
mac = [ "mlx>=0.0.1,<1.0", "parakeet-mlx>=0.0.1,<1.0",]
huggingface = [ "transformers>=4.36.0,<5.0", "accelerate>=0.25.0,<1.0",]
streaming = [ "whisper-streaming>=0.1.0,<1.0",]
wake_word = [ "openwakeword>=0.6.0,<1.0", "onnxruntime>=1.15.0,<2.0",]
dev = [ "pytest>=6.0,<9.0", "pytest-asyncio>=0.20.0,<1.0", "pytest-xdist>=3.0.0,<4.0", "pytest-sugar>=0.9.0,<2.0", "pytest-clarity>=1.0.0,<2.0", "pytest-html>=3.0.0,<5.0", "pytest-json-report>=1.5.0,<2.0", "rich>=13.0.0,<14.0", "ruff>=0.1.0,<1.0", "black>=22.0.0,<25.0", "mypy>=1.0.0,<2.0", "bandit>=1.7.0,<2.0", "pyyaml>=6.0.1,<7.0",]

[project.scripts]
ears = "matilda_ears.cli:cli_entry"
ears-server = "matilda_ears.transcription.server:main"

[tool.ruff]
cache-dir = ".artifacts/cache/ruff"
exclude = [ ".bzr", ".direnv", ".eggs", ".git", ".git-rewrite", ".hg", ".mypy_cache", ".nox", ".pants.d", ".pytype", ".ruff_cache", ".svn", ".tox", ".venv", "__pypackages__", "_build", "buck-out", "build", "dist", "node_modules", "venv", ".artifacts", "logs", "*.egg-info", "docker", ".pytest_cache", "/tmp",]
line-length = 120
indent-width = 4
target-version = "py311"

[tool.black]
line-length = 120
target-version = [ "py311",]
include = "\\.pyi?$"
extend-exclude = "/(\n  # directories\n  \\.eggs\n  | \\.git\n  | \\.hg\n  | \\.mypy_cache\n  | \\.tox\n  | \\.venv\n  | build\n  | dist\n  | venv\n  | \\.artifacts\n  | logs\n  | .*\\.egg-info\n  | docker\n  | \\.pytest_cache\n  | tmp\n)/\n"

[tool.mypy]
python_version = "3.11"
cache_dir = ".artifacts/cache/mypy"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = false
disallow_incomplete_defs = false
check_untyped_defs = true
disallow_untyped_decorators = false
no_implicit_optional = true
warn_redundant_casts = true
warn_unused_ignores = true
warn_no_return = true
warn_unreachable = true
strict_equality = true
exclude = [ "venv/", ".artifacts/", "logs/", "docker/", ".pytest_cache/", "build/", "dist/", "*.egg-info/",]
[[tool.mypy.overrides]]
module = [ "websockets.*", "faster_whisper.*", "deepmultilingualpunctuation.*", "spacy.*", "opuslib.*", "silero_vad.*", "torchaudio.*", "ctranslate2.*", "numpy.*", "pynput.*", "whisper_online.*", "soundfile.*", "parakeet_mlx.*", "mlx.*", "openwakeword.*",]
ignore_missing_imports = true

[tool.pylint]
max-line-length = 120
disable = [ "missing-docstring", "too-few-public-methods", "too-many-arguments", "too-many-locals", "too-many-branches", "too-many-statements", "import-outside-toplevel", "broad-except",]

[tool.bandit]
exclude_dirs = [ "tests", "venv",]
skips = [ "B602", "B603", "B607",]

[tool.ruff.lint]
select = [ "E", "F", "W", "C", "N", "D", "UP", "YTT", "ANN", "ASYNC", "S", "BLE", "FBT", "B", "A", "COM", "C4", "DTZ", "T10", "DJ", "EM", "EXE", "FA", "ISC", "ICN", "G", "INP", "PIE", "T20", "PYI", "PT", "Q", "RSE", "RET", "SLF", "SLOT", "SIM", "TID", "TCH", "INT", "ARG", "PTH", "ERA", "PD", "PGH", "PL", "TRY", "FLY", "NPY", "AIR", "PERF", "FURB", "LOG", "RUF",]
ignore = [ "D100", "D101", "D102", "D103", "D104", "D105", "D106", "D107", "D400", "D401", "D415", "ANN001", "ANN002", "ANN003", "ANN201", "ANN202", "ANN204", "ANN205", "ANN206", "FA100", "S602", "S603", "S607", "PLR0913", "PLR2004", "C901", "PLR0911", "PLR0912", "PLR0915", "FBT001", "FBT002", "COM812", "ISC001", "BLE001", "G004", "TRY003", "TRY300", "TRY400", "TRY401", "PERF203", "E501", "RET501", "RET502", "RET503", "RET504", "RET505", "RET506", "RET507", "RET508", "SIM102", "SIM117", "PLC0415", "EXE001", "TID252", "EM101", "EM102", "ERA001", "PLW0603", "RUF001", "T201", "ARG001", "ARG002", "PTH100", "PTH103", "PTH107", "PTH110", "PTH118", "PTH119", "PTH120", "PTH123", "S105", "B904", "TRY301", "SIM105", "RUF013", "PERF401", "N801", "N802", "N803", "N806", "RUF022", "RUF002", "B007", "B023", "SLF001", "DTZ003", "DTZ005", "DTZ006", "SIM108", "SIM103", "SIM110", "S104", "S110", "PTH101", "PTH108", "PTH202", "RUF005", "TC002", "TC003", "ASYNC110", "ASYNC230", "RUF006", "ANN401", "F841", "D200", "D205", "D417", "INP001", "ARG005", "RUF003", "RUF015", "RUF059", "PLR1714", "PLW2901", "PERF403", "G201", "FA102", "E702", "W293", "TRY002", "B025", "S108",]
fixable = [ "ALL",]
unfixable = []

[tool.ruff.format]
quote-style = "double"
indent-style = "space"
skip-magic-trailing-comma = false
line-ending = "auto"

[tool.setuptools.package-data]
matilda_ears = [ "**/*.json", "setup.sh",]
goobits_matilda_ears = [ "setup.sh",]

[tool.pytest.ini_options]
cache_dir = ".artifacts/cache/pytest"
testpaths = [ "tests",]
asyncio_mode = "auto"

[tool.coverage.run]
source = [ "src/matilda_ears",]
data_file = ".artifacts/cache/.coverage"
omit = [ "*/tests/*", "*/venv/*", "*/__pycache__/*",]

[tool.coverage.report]
precision = 2
show_missing = true
skip_covered = false

[tool.coverage.html]
directory = ".artifacts/cache/htmlcov"

[tool.ruff.lint.per-file-ignores]
"src/matilda_ears/app_hooks.py" = [ "T201", "PLC0415", "EXE001",]
"src/matilda_ears/cli.py" = [ "T201",]
"src/matilda_ears/modes/__init__.py" = [ "F401",]
"src/matilda_ears/transcription/backends/huggingface_backend.py" = [ "F401",]
"src/matilda_ears/transcription/backends/parakeet_backend.py" = [ "F401",]
"scripts/*.py" = [ "E402",]
"tests/**/conftest.py" = [ "E402",]
"tests/**/*.py" = [ "S101",]

[tool.setuptools.packages.find]
where = [ "src", ".",]
include = [ "matilda_ears*", "goobits_matilda_ears*",]
exclude = [ "tests*", "docker*", "scripts*", "**/__pycache__", "*.egg-info", "build", "dist",]
